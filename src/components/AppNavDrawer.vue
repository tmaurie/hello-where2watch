<template>
  <div>
    <v-navigation-drawer
        app
        floating
        class="rounded-lg"
        :class='{ "my-4": $vuetify.breakpoint.mdAndUp, "my-2": $vuetify.breakpoint.smAndDown, "mx-4": $vuetify.breakpoint.mdAndUp && drawer, "mx-2": $vuetify.breakpoint.smAndDown && drawer }'
        overlay-opacity=".75"
        v-model="drawer"
        :width='$vuetify.breakpoint.smAndDown ? 310 : 360'
        :height='`calc(100vh - ${$vuetify.breakpoint.smAndDown ? "16" : "32"}px)`'
        temporary
    >
      <v-list-item>
        <v-list-item-content>
          <v-list-item-title class="text-h6">
            Where2Watch
          </v-list-item-title>
          <v-list-item-subtitle>
            Menu
          </v-list-item-subtitle>
        </v-list-item-content>
      </v-list-item>
      <v-list-item to="/">
        <v-list-item-icon>
          <v-icon>mdi-home</v-icon>
        </v-list-item-icon>

        <v-list-item-title>Home</v-list-item-title>
      </v-list-item>
      <v-list nav>


        <v-list-item
            to="/w/">
          <v-list-item-icon>
            <v-icon>mdi-binoculars</v-icon>
          </v-list-item-icon>
          <v-list-item-title>Discover</v-list-item-title>
        </v-list-item>

        <v-list-group
            :value="false"
            prepend-icon="mdi-television-play"
            no-action

        >
          <template v-slot:activator>
            <v-list-item-title>Platforms</v-list-item-title>
          </template>

          <v-list-item
              v-for="(item, i) in items"
              :key="i"
              link
              :to="item.route"
          >
            <v-list-item-title v-text="item.text"></v-list-item-title>
            <v-img :src="item.icon"></v-img>
          </v-list-item>


        </v-list-group>
        <v-list-item @click="getRandom">
          <v-list-item-icon>
            <v-icon>mdi-dice-5</v-icon>
          </v-list-item-icon>
          <v-list-item-title>Get me random !</v-list-item-title>
        </v-list-item>
        <v-list-item to="/search">
          <v-list-item-icon>
            <v-icon>mdi-feature-search</v-icon>
          </v-list-item-icon>
          <v-list-item-title>Custom Search</v-list-item-title>
        </v-list-item>
      </v-list>

      <template v-slot:append>
        <div class="pa-2">
          <v-btn block href="https://github.com/tmaurie/hello-where2watch" target="_blank">
            <v-icon>mdi-github</v-icon>
            Github
          </v-btn>
        </div>
      </template>
    </v-navigation-drawer>

    <v-app-bar
        app
        elevation="0"
    >

      <v-app-bar-nav-icon @click.stop="drawer = !drawer"></v-app-bar-nav-icon>

      <v-toolbar-title v-bind:style="{cursor : 'pointer'}" @click="$router.push({path: `/`})">
        <svg height="40" viewBox="0 0 158 71" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
              d="M10.896 32.576C10.8 32.576 10.448 32.384 9.84 32L3.312 6.8L0.336 5.84V2.72H14.352V6.176L11.904 7.04L13.68 16.352L15.168 24.56H15.648C17.44 18.928 18.896 14.048 20.016 9.92L19.248 6.8L16.704 5.792V2.72H30.384V6.224L27.408 7.04L29.328 16.352L31.008 24.56H31.488C31.904 22.928 32.56 20.112 33.456 16.112C34.352 12.08 34.992 9.056 35.376 7.04L32.736 6.176V2.72H45.168V5.84L42.192 6.8L39.936 14.528C37.568 22.368 35.888 28.096 34.896 31.712C33.968 31.808 32.608 31.952 30.816 32.144C29.056 32.368 27.712 32.512 26.784 32.576C26.688 32.576 26.336 32.384 25.728 32L22.8 20.432H22.272L19.008 31.712C18.08 31.808 16.72 31.952 14.928 32.144C13.168 32.368 11.824 32.512 10.896 32.576ZM49.7933 32.576C49.6013 32.576 49.1693 32.288 48.4973 31.712C47.8253 31.136 47.4893 30.752 47.4893 30.56V5.024L45.4733 4.304V1.28C50.0813 0.607999 52.6253 0.271999 53.1053 0.271999C53.2653 0.271999 53.6173 0.559999 54.1613 1.136C54.7053 1.68 54.9773 2.048 54.9773 2.24L54.5933 12.224L54.9293 12.272C55.7613 11.632 56.6413 10.992 57.5693 10.352C58.4973 9.68 59.0413 9.344 59.2013 9.344C61.7293 9.344 63.6173 9.872 64.8653 10.928C66.1133 11.984 66.7373 13.824 66.7373 16.448V27.776L68.7053 28.496V31.472C64.3853 32.208 62.0173 32.576 61.6013 32.576C61.3773 32.576 60.9293 32.304 60.2573 31.76C59.5853 31.184 59.2493 30.784 59.2493 30.56V16.544C59.2493 15.744 59.0733 15.2 58.7213 14.912C58.3693 14.624 58.0013 14.48 57.6172 14.48C57.4253 14.48 56.5453 14.848 54.9773 15.584V27.776L56.9453 28.496V31.472C52.6253 32.208 50.2413 32.576 49.7933 32.576ZM80.031 32.624C77.055 32.624 74.719 31.696 73.023 29.84C71.359 27.984 70.527 25.44 70.527 22.208C70.527 20.8 70.655 19.392 70.911 17.984C71.167 16.544 71.455 15.408 71.775 14.576C72.191 14.096 73.023 13.424 74.271 12.56C75.551 11.696 76.815 10.944 78.063 10.304C79.343 9.632 80.223 9.296 80.703 9.296C82.687 9.296 84.303 9.664 85.551 10.4C86.831 11.104 87.807 12.336 88.479 14.096C89.151 15.824 89.487 18.192 89.487 21.2L78.207 22.16C78.207 23.696 78.495 24.944 79.071 25.904C79.679 26.864 80.431 27.344 81.327 27.344L88.719 27.008V30.08C87.183 30.624 85.471 31.184 83.583 31.76C81.695 32.336 80.511 32.624 80.031 32.624ZM82.383 18.272C82.383 16.832 82.239 15.616 81.951 14.624C81.663 13.632 81.263 13.056 80.751 12.896C80.527 12.832 80.255 12.8 79.935 12.8C79.647 12.768 79.455 12.768 79.359 12.8C79.135 12.832 78.895 13.44 78.639 14.624C78.415 15.776 78.271 17.184 78.207 18.848L82.383 18.272ZM95.4619 32.576C95.2699 32.576 94.8379 32.288 94.1659 31.712C93.4939 31.136 93.1579 30.752 93.1579 30.56V14.048L91.1419 13.376V10.352C95.5259 9.68 97.9579 9.344 98.4379 9.344C98.5979 9.344 98.9499 9.632 99.4939 10.208C100.07 10.784 100.358 11.168 100.358 11.36V13.52C101.254 12.432 102.118 11.44 102.95 10.544C103.782 9.616 104.278 9.152 104.438 9.152C105.046 9.152 105.686 9.232 106.358 9.392C107.03 9.52 107.574 9.664 107.99 9.824C108.022 9.92 108.134 10.24 108.326 10.784C108.518 11.296 108.614 11.776 108.614 12.224C108.614 12.672 108.262 13.632 107.558 15.104C106.886 16.576 106.454 17.312 106.262 17.312C106.198 17.28 105.782 17.072 105.014 16.688C104.246 16.304 103.638 16.112 103.19 16.112C103.03 16.112 102.614 16.224 101.942 16.448C101.27 16.672 100.838 16.832 100.646 16.928V27.248L103.958 28.16V31.328C98.8379 32.16 96.0059 32.576 95.4619 32.576ZM118.469 32.624C115.493 32.624 113.157 31.696 111.461 29.84C109.797 27.984 108.965 25.44 108.965 22.208C108.965 20.8 109.093 19.392 109.349 17.984C109.605 16.544 109.893 15.408 110.213 14.576C110.629 14.096 111.461 13.424 112.709 12.56C113.989 11.696 115.253 10.944 116.501 10.304C117.781 9.632 118.661 9.296 119.141 9.296C121.125 9.296 122.741 9.664 123.989 10.4C125.269 11.104 126.245 12.336 126.917 14.096C127.589 15.824 127.925 18.192 127.925 21.2L116.645 22.16C116.645 23.696 116.933 24.944 117.509 25.904C118.117 26.864 118.869 27.344 119.765 27.344L127.157 27.008V30.08C125.621 30.624 123.909 31.184 122.021 31.76C120.133 32.336 118.949 32.624 118.469 32.624ZM120.821 18.272C120.821 16.832 120.677 15.616 120.389 14.624C120.101 13.632 119.701 13.056 119.189 12.896C118.965 12.832 118.693 12.8 118.373 12.8C118.085 12.768 117.893 12.768 117.797 12.8C117.573 12.832 117.333 13.44 117.077 14.624C116.853 15.776 116.709 17.184 116.645 18.848L120.821 18.272ZM137.788 29.024L145.132 20.096C146.092 18.912 146.796 17.904 147.244 17.072C147.692 16.24 147.916 15.456 147.916 14.72C147.916 14.208 147.82 13.712 147.628 13.232C147.436 12.752 147.196 12.512 146.908 12.512C146.652 12.512 146.06 12.608 145.132 12.8C144.236 12.96 143.708 13.056 143.548 13.088L143.068 17.072H139.372L139.036 9.488C140.412 9.264 142.316 9.04 144.748 8.816C147.18 8.592 148.748 8.48 149.452 8.48C151.34 8.48 152.988 8.944 154.396 9.872C155.804 10.768 156.508 12.16 156.508 14.048C156.508 15.168 156.3 16.224 155.884 17.216C155.468 18.208 154.812 19.28 153.916 20.432L148.876 26.768V27.392H153.196L153.772 23.984H157.468L157.66 32H138.268L137.788 29.024ZM10.896 70.576C10.8 70.576 10.448 70.384 9.84 70L3.312 44.8L0.336 43.84V40.72H14.352V44.176L11.904 45.04L13.68 54.352L15.168 62.56H15.648C17.44 56.928 18.896 52.048 20.016 47.92L19.248 44.8L16.704 43.792V40.72H30.384V44.224L27.408 45.04L29.328 54.352L31.008 62.56H31.488C31.904 60.928 32.56 58.112 33.456 54.112C34.352 50.08 34.992 47.056 35.376 45.04L32.736 44.176V40.72H45.168V43.84L42.192 44.8L39.936 52.528C37.568 60.368 35.888 66.096 34.896 69.712C33.968 69.808 32.608 69.952 30.816 70.144C29.056 70.368 27.712 70.512 26.784 70.576C26.688 70.576 26.336 70.384 25.728 70L22.8 58.432H22.272L19.008 69.712C18.08 69.808 16.72 69.952 14.928 70.144C13.168 70.368 11.824 70.512 10.896 70.576ZM52.7719 70.576C50.1159 70.576 48.0359 69.648 46.5319 67.792C45.0599 65.936 44.3239 63.376 44.3239 60.112C44.3239 58.736 44.4359 57.344 44.6599 55.936C44.9159 54.528 45.2199 53.408 45.5719 52.576C45.9879 52.096 46.8199 51.44 48.0679 50.608C49.3479 49.744 50.6119 48.992 51.8599 48.352C53.1079 47.68 53.9719 47.344 54.4519 47.344C54.7719 47.344 56.2279 47.552 58.8199 47.968C61.4439 48.384 63.2679 48.672 64.2919 48.832V65.824L66.3079 66.544V69.568C61.8919 70.24 59.4439 70.576 58.9639 70.576C58.8039 70.576 58.4519 70.304 57.9079 69.76C57.3639 69.184 57.0919 68.8 57.0919 68.608V67.456C54.4039 69.536 52.9639 70.576 52.7719 70.576ZM54.2119 65.44C54.4039 65.44 54.8679 65.248 55.6039 64.864C56.3399 64.48 56.7399 64.272 56.8039 64.24V52.384C54.9479 51.168 53.8439 50.656 53.4919 50.848C52.6919 51.296 52.2919 54.176 52.2919 59.488C52.2919 61.12 52.4839 62.528 52.8679 63.712C53.2519 64.864 53.6999 65.44 54.2119 65.44ZM74.2815 70.576C73.9295 70.576 73.4335 70.304 72.7935 69.76C72.1535 69.184 71.5775 68.528 71.0655 67.792C70.5855 67.056 70.3455 66.448 70.3455 65.968V51.76H66.8415V48.976L70.3455 47.68L75.0495 42.16C75.3375 42.032 76.2655 42.272 77.8335 42.88V47.968H82.6815V51.856H77.8335V63.952C77.8335 65.136 78.1855 65.728 78.8895 65.728L83.2575 66.016V69.616C81.7855 69.84 80.0255 70.048 77.9775 70.24C75.9295 70.464 74.6975 70.576 74.2815 70.576ZM93.2273 70.576C90.5393 70.576 88.4433 69.648 86.9393 67.792C85.4353 65.936 84.6833 63.392 84.6833 60.16C84.6833 58.752 84.7953 57.376 85.0193 56.032C85.2753 54.656 85.5793 53.552 85.9313 52.72C86.3473 52.24 87.1633 51.568 88.3793 50.704C89.6273 49.808 90.8753 49.024 92.1233 48.352C93.3713 47.68 94.2193 47.344 94.6673 47.344C95.5633 47.344 96.6193 47.456 97.8353 47.68C99.0513 47.872 100.155 48.128 101.147 48.448L101.003 55.84H96.8753L96.0113 51.952C95.2433 51.472 94.6033 51.232 94.0913 51.232C93.8353 51.232 93.6433 51.296 93.5153 51.424C93.1953 51.68 92.9393 52.496 92.7473 53.872C92.5873 55.216 92.5073 56.896 92.5073 58.912C92.5073 60.8 92.7633 62.32 93.2753 63.472C93.8193 64.592 94.6193 65.152 95.6753 65.152H101.147V68.224C100.923 68.288 99.8033 68.704 97.7873 69.472C95.8033 70.208 94.2833 70.576 93.2273 70.576ZM106.653 70.576C106.461 70.576 106.029 70.288 105.357 69.712C104.685 69.136 104.349 68.752 104.349 68.56V43.024L102.333 42.304V39.28C106.941 38.608 109.485 38.272 109.965 38.272C110.125 38.272 110.477 38.56 111.021 39.136C111.565 39.68 111.837 40.048 111.837 40.24L111.453 50.224L111.789 50.272C112.621 49.632 113.501 48.992 114.429 48.352C115.357 47.68 115.901 47.344 116.061 47.344C118.589 47.344 120.477 47.872 121.725 48.928C122.973 49.984 123.597 51.824 123.597 54.448V65.776L125.565 66.496V69.472C121.245 70.208 118.877 70.576 118.461 70.576C118.237 70.576 117.789 70.304 117.117 69.76C116.445 69.184 116.109 68.784 116.109 68.56V54.544C116.109 53.744 115.933 53.2 115.581 52.912C115.229 52.624 114.861 52.48 114.477 52.48C114.285 52.48 113.405 52.848 111.837 53.584V65.776L113.805 66.496V69.472C109.485 70.208 107.101 70.576 106.653 70.576Z"
              fill="var(rgb(--font-color))"/>
        </svg>
      </v-toolbar-title>
      <v-spacer></v-spacer>
      <SearchBox/>
      <v-spacer></v-spacer>

      <LoginComponent />
      <v-btn icon @click="$vuetify.theme.dark = !$vuetify.theme.dark">
        <v-icon>
          {{ $vuetify.theme.dark ? "mdi-white-balance-sunny" : "mdi-brightness-3" }}
        </v-icon>
      </v-btn>
    </v-app-bar>


  </div>
</template>
<script>
import SearchBox from "@/components/SearchBox";
import axios from "axios";
import LoginComponent from "@/components/LoginComponent";

export default {
  components: {LoginComponent, SearchBox},
  data: () => ({
    drawer: false,
    selectedItem: 0,
    items: [
      {text: 'Netflix', route: '/w/8', icon: require('@/assets/img/icon-netflix.png')},
      {text: 'Prime Videos', route: '/w/119', icon: require('@/assets/img/icon-amazon.png')},
      {text: 'Disney+', route: '/w/337', icon: require('@/assets/img/icon-disney.png')},
    ],
  }),
  watch: {
    group() {
      this.drawer = false
    },
  },
  methods: {
    getRandom() {
      let randomPage = Math.floor(Math.random() * 30)
      let randomItem = Math.floor(Math.random() * 19)
      axios.get('https://api.themoviedb.org/3/movie/top_rated', {
        params: {
          api_key: process.env.VUE_APP_API_KEY,
          page: randomPage
        }
      }).then((response) => {
        this.randomId = response.data.results[randomItem].id

        this.$router.push({path: `/m/${this.randomId}`})
      })

    }
  }
}
</script>
